<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Semantic Objects Modeling Language</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Vladimir Alexiev" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type='text/css'> h1,h2,h3,h4,h5,h6,h7 {font-family: Arial} .author, .date, .creator {-webkit-margin-before: 0em; -webkit-margin-after: 0em} .abstract {margin: 1em; padding: 1em; border: 1px solid black} .abstract:before {content: 'Abstract: '; font-weight: bold} #preamble p {font-size: 110%%; margin-left: auto; margin-right: auto; text-align: center} th.left {text-align:left} th.right {text-align:right} th, td {line-height: 1em; border-width: 1px; border-style: solid solid; border-spacing: 2px 2px; padding: 2px 1px} .CANCELED {color: blue} .MAYBE {color: blue} .POSTPONED {color: blue} .SAME {color: blue} .APPLIED {color: orange} .FOLLOW {color: orange} .INPROGRESS {color: orange} .NEXT {color: orange} .IER {color: orange}.underline {text-decoration:underline} </style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Semantic Objects Modeling Language</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgb38028f">Intro</a>
<ul>
<li><a href="#org559ae9f">Why SOML?</a></li>
<li><a href="#org1e942f6">Similar Schema Languages</a></li>
<li><a href="#org9466d6d">What is SOML</a></li>
</ul>
</li>
<li><a href="#org89956a1">Complex Schema (Company Graph)</a>
<ul>
<li><a href="#org57936a4">Example Class:</a></li>
<li><a href="#org6b550ad">Example Inverse Alias</a></li>
<li><a href="#orgb3f78d3">Example Diagram: Exchange Listing</a></li>
</ul>
</li>
<li><a href="#org3c424ab">SOML Tooling</a>
<ul>
<li><a href="#orgae2c348">tsv2soml</a></li>
<li><a href="#org893dfe5">soml-map</a></li>
</ul>
</li>
<li><a href="#orga0f12e8">Tricky Points and Deficiencies</a>
<ul>
<li><a href="#org15d8bbf">GraphQL Type vs rdf:type</a></li>
<li><a href="#org9fce966">No Multiple Typing</a></li>
<li><a href="#orgf0fb16a">Single vs Multiple-Value Props</a></li>
<li><a href="#org2812962">Inverse Aliases</a></li>
<li><a href="#orgd69d00d">Literals (langString, union datatypes)</a></li>
<li><a href="#orgd2e987c">Extended Pattern (Prefix + Regex)</a></li>
<li><a href="#org019f209">IRI Generation</a></li>
<li><a href="#orgde99a22">Schema Inclusion/Modularity</a></li>
<li><a href="#orgeee9558">Concrete Superclass</a></li>
<li><a href="#org9e001b9">Covariant Range</a></li>
<li><a href="#org8e2065f">Multiple Inheritance</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgb38028f" class="outline-2">
<h2 id="orgb38028f">Intro</h2>
<div class="outline-text-2" id="text-orgb38028f">
<p>
The Semantic Objects Modeling Language (SOML)
is a simple YAML-based language for describing business objects (business entities, domain objects) 
that are handled using semantic technologies and GraphQL.
SOML is the language of the Ontotext Platform.
</p>

<p>
The Ontotext Platform helps create knowledge graphs in an easier way,
both using and enabling text analytics to interlink and enrich knowledge graphs,
and enabling better search, exploration, classification, and recommendation across diverse information spaces.
</p>

<p>
The platform was released at the end of 2019 and is under active develoment and evolution.
</p>
<ul class="org-ul">
<li>It is documented at <a href="http://platform.ontotext.com/">http://platform.ontotext.com/</a>, including:
<ul class="org-ul">
<li><a href="http://platform.ontotext.com/semantic-objects/semantic-objects.html">Semantic Objects as a Service (SOaaS)</a></li>
<li><a href="http://platform.ontotext.com/soml/index.html">Semantic Objects Modeling Language (SOML)</a></li>
<li><a href="http://platform.ontotext.com/tutorials/soaas-tutorial.html">SOaaS Tutorial</a></li>
</ul></li>
<li>The blog post <a href="https://www.ontotext.com/blog/the-rise-of-the-knowledge-graph/">A New Hope: The Rise of the Knowledge Graph</a> 
(Navigating through the Star Wars universe with knowledge graphs, SPARQL and GraphQL),
6 December 2019
introduces the platform, 
compares RDF and GraphQL representations of a domain (Star Wars),
and shows interactive GraphQL queries.</li>
</ul>

<p>
This blog goes in-depth on SOML: 
motivates the use of SOML, 
describes some tricky points of SOML usage and GraphQL deficiencies,
and introduces some SOML tooling for 
generating SOML (<code>tsv2soml</code>) and mapping RDF data (<code>soml-map</code>)
</p>
</div>

<div id="outline-container-org559ae9f" class="outline-3">
<h3 id="org559ae9f">Why SOML?</h3>
<div class="outline-text-3" id="text-org559ae9f">
<p>
We often are asked why we had to introduce yet another object modeling language?
Why didn't we use existing semantic web mechanisms such as 
ontologies (RDFS or OWL) or shapes (SHACL or SHEX),
or schema mechanisms such as GraphQL schema, JSON schema and the like?
The answer is multi-fold:
</p>
<dl class="org-dl">
<dt>Semantic models are more than ontologies</dt><dd>Every sizable semantic project (and many LOD datasets) use a number of ontologies together.
While ontologies describe the vocabulary of classes and properties to use,
extra mechanisms are required to describe how these elements are put together,
and what are the data expectations about different kinds of nodes in the graph.
One could do some of that with ontologies, 
e.g. use OWL property cardinalities, 
complex OWL classes to define polymorphic domains and ranges,
and XSD datatype constructions to describe literal patterns.
However, the inferential rather than validation semantics of RDFS and OWL 
and their inherent complexity 
have led people to use application profiles and RDF shapes instead.</dd>
<dt>Lack of standardization</dt><dd>While there are several implementations of GraphQL querying over RDF,
each of them does it in a different way and there is no standardization.
The <a href="https://www.topquadrant.com/graphql/graphql-shacl.html">TopQuadrant GraphQL to SHACL</a> mapping comes close to using 
SHACL for generating GraphQL schemas, but still uses custom extensions.
Definitive mappings between SHACL and SHEX are not available.
The <a href="https://www.w3.org/community/graphql-rdf/">Bridging GraphQL and RDF</a> W3C Community Group has been launched (Jan 2020)
with the mission to close this gap,
and hopefully define standard mappings/crosswalks between SHACL, SHEX and 
GraphQL schemas and validation mechanisms.
We plan to participate actively in this group.</dd>
<dt>Freedom to innovate</dt><dd>Our ambition is for the Ontotext platform to cover a wide variety of enterprise features.
To be able to develop them at our own pace, we need a language where we can add such innovations.
Examples include
data validation based on RDF shapes (generated from SOML);
Role-Based Access Control (RBAC);
faceting, autocompletion and full-text search;
aggregation;
distribution of data to various stores through GraphDB Connectors and/or GraphQL Federation.</dd>
<dt>Technology independence</dt><dd>Flowing from the previous reason, we'd like SOML to be technology-independent to some degree.
While we don't aim for a theoretical develpment that lives in a technological vacuum,
we need to be able to generate a number of technical artefacts from the same business-level model.</dd>
</dl>
</div>
</div>

<div id="outline-container-org1e942f6" class="outline-3">
<h3 id="org1e942f6">Similar Schema Languages</h3>
<div class="outline-text-3" id="text-org1e942f6">
<p>
A number of schema languages have appeared recently that are based on YAML,
express business-level object models that are somewhat independent of technological choices,
and can render the models to a variety of schema technologies:
</p>

<ul class="org-ul">
<li><a href="https://biolink.github.io/biolinkml/%3E">BioLink modeling language</a>.
Models are authored in YAML. A variety of artefacts can be generated, including SHEX, JSON-Schema, OWL, Python dataclasses, ElasticSearch type definitions, 
UML diagrams, Markdown pages for deployment in a GitHub pages site, etc.</li>
<li><a href="https://www.hl7.org/fhir/%3E">HL7 FHIR</a>, which is a business-level language for expressing Health Care models 
and has renditions in UML, XML, JSON, Turtle, SHEX.</li>
<li><b>a.ml</b>: <a href="https://a.ml/%3E">Anything Modeling Language</a> (see <a href="https://a.ml/docbook/%3E">documentation</a>, <a href="https://a.ml/aml-spec/vocabularies/%3E">vocabularies</a>, <a href="https://a.ml/aml-spec/dialects/%3E">dialects</a>),
which targets mapping of YAML schemas to ontologies and SHACL shapes, 
and YAML documents to RDF graphs.</li>
<li><a href="https://cloudinformationmodel.org/about.html%3E">Cloud Information Model (CIM)</a>, which targets
AML Vocabulary (conceptual model),
AML Dialect (data shapes),
RDFS (entities and relationships),
SHACL (data shapes and constraints),
SQL DDL (relational database schema),
R2RML (mapping from relational schema to RDF),
RAML (REST API data types),
JSON Schema (data shapes)</li>
<li>The Uber Graph Schema Languag, a YAML language that is
used to generate various artefacts (ProtoBuf, Avro, RDFS ontology, etc) 
and to integrate <b>200 thousand</b> datasets at Uber.
While not publically available, it's described in presentations by <a href="https://www.slideshare.net/joshsh">Joshua Shinavier</a> including:
<ul class="org-ul">
<li><a href="https://www.slideshare.net/joshsh/a-graph-is-a-graph-is-a-graph-equivalence-transformation-and-composition-of-graph-data-models-129403012/1">A Graph is a Graph is a Graph: Equivalence, Transformation, and Composition of Graph Data Models</a> (Jan 2019).</li>
<li><a href="https://www.slideshare.net/joshsh/building-an-enterprise-knowledge-graph-uber-lessons-from-reality">Building an Enterprise Knowledge Graph @Uber: Lessons from Reality</a> (May 2019)</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org9466d6d" class="outline-3">
<h3 id="org9466d6d">What is SOML</h3>
<div class="outline-text-3" id="text-org9466d6d">
<p>
At present SOML is very simple, but will evolve to include more features.
The overall structure of a SOML file (schema) is shown below.
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #b22222;"># </span><span style="color: #b22222;">comment</span>
<span style="color: #a0522d;">id</span>:          /soml/&lt;identifier&gt;
<span style="color: #a0522d;">label</span>:       some name
<span style="color: #a0522d;">created</span>:     yyyy-mm-dd
<span style="color: #a0522d;">updated</span>:     yyyy-mm-dd
<span style="color: #a0522d;">creator</span>:     name and/or URL
<span style="color: #a0522d;">versionInfo</span>: version

<span style="color: #b22222;"># </span><span style="color: #b22222;">comment</span>
<span style="color: #a0522d;">specialPrefixes</span>:
  <span style="color: #a0522d;">base_iri</span>:     &lt;base&gt;
  <span style="color: #a0522d;">vocab_iri</span>:    &lt;vocab&gt;
  <span style="color: #a0522d;">vocab_prefix</span>: &lt;voc&gt;
  <span style="color: #a0522d;">ontology_iri</span>: &lt;ontology&gt;
  <span style="color: #a0522d;">shape_iri</span>:    &lt;shape&gt;
<span style="color: #a0522d;">prefixes</span>:
  <span style="color: #a0522d;">&lt;pfx&gt;</span>:        &lt;namespace&gt;

<span style="color: #b22222;"># </span><span style="color: #b22222;">datatypes</span>
<span style="color: #a0522d;">types</span>:
  <span style="color: #a0522d;">&lt;type&gt;</span>:       {<span style="color: #a0522d;">rdf</span>: &lt;xsd-type&gt;,    <span style="color: #a0522d;">graphql</span>: &lt;GQL-type&gt;, <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"..."</span>, <span style="color: #a0522d;">graphqlExtension</span>: &lt;boolean&gt;}
  <span style="color: #a0522d;">&lt;union-type&gt;</span>: {<span style="color: #a0522d;">union</span>: [&lt;type&gt;...], <span style="color: #a0522d;">graphql</span>: &lt;GQL-type&gt;, <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"..."</span>}

<span style="color: #b22222;"># </span><span style="color: #b22222;">common property definitions</span>
<span style="color: #a0522d;">properties</span>:
  <span style="color: #a0522d;">&lt;prop&gt;</span>:  {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"..."</span>, <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"..."</span>, <span style="color: #a0522d;">range</span>: &lt;datatype|Obj&gt;, <span style="color: #a0522d;">rangeCheck</span>: &lt;boolean&gt;, <span style="color: #a0522d;">typeCast</span>: &lt;boolean&gt;,
            <span style="color: #a0522d;">kind</span>: (object|literal|mixed), <span style="color: #a0522d;">min</span>: &lt;default 0&gt;, <span style="color: #a0522d;">max</span>: &lt;default 1&gt;,
            <span style="color: #a0522d;">inverseAlias</span>: &lt;prop&gt;, <span style="color: #a0522d;">inverse</span>: &lt;prop&gt;, <span style="color: #a0522d;">rdfProp</span>: pfx:prop, <span style="color: #a0522d;">symmetric</span>: &lt;boolean&gt;, <span style="color: #a0522d;">regex</span>: <span style="color: #8b2252;">'&lt;regex&gt;'</span>, <span style="color: #a0522d;">prefix</span>: <span style="color: #8b2252;">"&lt;string&gt;"</span>}

<span style="color: #b22222;"># </span><span style="color: #b22222;">object class definitions</span>
<span style="color: #a0522d;">objects</span>:
  <span style="color: #a0522d;">&lt;Obj&gt;</span>:  {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"..."</span>, <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"..."</span>, <span style="color: #a0522d;">regex</span>: <span style="color: #8b2252;">'&lt;regex&gt;'</span>, <span style="color: #a0522d;">prefix</span>: <span style="color: #8b2252;">"&lt;string&gt;"</span>,
           <span style="color: #a0522d;">typeProp</span>: &lt;prop&gt;, <span style="color: #a0522d;">type</span>: [&lt;iri&gt;...], <span style="color: #a0522d;">name</span>: &lt;prop&gt;, <span style="color: #a0522d;">inherits</span>: &lt;Obj&gt;, <span style="color: #a0522d;">kind</span>: (abstract|supertype)}
    <span style="color: #a0522d;">props</span>:
      <span style="color: #a0522d;">&lt;prop&gt;</span>: ...

</pre>
</div>

<p>
From this schema the Platform generates a complex GraphQL schema 
including a fairly complete querying language that allows you to
find any kind of object, filter, order, navigate through the KG, 
and do pagination (limit, offset).
</p>

<p>
You can find details in the <a href="http://platform.ontotext.com/soml/index.html">SOML documentation</a>, while below we describe 
some tricky points of SOML usage and GraphQL deficiencies, and some tooling.
</p>
</div>
</div>
</div>

<div id="outline-container-org89956a1" class="outline-2">
<h2 id="org89956a1">Complex Schema (Company Graph)</h2>
<div class="outline-text-2" id="text-org89956a1">
<p>
To introduce the proper context for this blog (working with complex SOML schemas),
we'll describe the Ontotext Company Graph (ONTO CG) ontology and model.
It's a medium-high complexity data model that reuses 14 ontologies and adds classes and props of its own.
Of its 24 classes and 150 props, about half are reused and half are created especially for CG.
It's fairly typical data model for the kind of projects that Ontotext deals with.
</p>

<p>
Creating the ONTO CG knowledge graph is part of
the <a href="https://www.ontotext.com/cima/">Intelligent Matching and Linking of Company Data (CIMA)</a> research project.
We are integrating data from open and a few proprietary datasets. The emphasis of the project is on financial transactions, industrial classification, company size/importance observations (e.g. annual sales, number of employees), etc.
</p>

<p>
The following table shows the count of classes and properties defined by the ONTO-CG ontology, as well as those reused from other ontologies.
</p>

<table border="1" cellspacing="0" cellpadding="2" rules="all" frame="box">
<caption class="t-above"><span class="table-number">Table 1:</span> Ontology reuse and extension in Ontotext Company Graph.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Prefix</th>
<th scope="col" class="org-left">Ontology</th>
<th scope="col" class="org-right">Classes</th>
<th scope="col" class="org-right">Props</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">cg</td>
<td class="org-left">Ontotext Company Graph</td>
<td class="org-right">12</td>
<td class="org-right">70</td>
</tr>

<tr>
<td class="org-left">adms</td>
<td class="org-left">Asset Description Metadata Schema</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">dcat</td>
<td class="org-left">Data Catalog Vocabulary</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">dct</td>
<td class="org-left">Dublin Core Terms</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">ebg</td>
<td class="org-left">euBusinessGraph</td>
<td class="org-right">1</td>
<td class="org-right">12</td>
</tr>

<tr>
<td class="org-left">gn</td>
<td class="org-left">GeoNames</td>
<td class="org-right">1</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-left">locn</td>
<td class="org-left">W3C Location Ontology</td>
<td class="org-right">1</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">org</td>
<td class="org-left">W3C Core Organization Ontology</td>
<td class="org-right">1</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">qb</td>
<td class="org-left">W3C Cube Ontology</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">rov</td>
<td class="org-left">W3C Registered Organization</td>
<td class="org-right">1</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">schema</td>
<td class="org-left">Schema.org</td>
<td class="org-right">3</td>
<td class="org-right">12</td>
</tr>

<tr>
<td class="org-left">skos</td>
<td class="org-left">Simple Knowledge Organization System</td>
<td class="org-right">1</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">time</td>
<td class="org-left">W3C Time Ontology</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">void</td>
<td class="org-left">Vocabulary of Interlinked Datasets</td>
<td class="org-right">1</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-left">wgs84</td>
<td class="org-left">World Geodetic Survey</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">24</td>
<td class="org-right">150</td>
</tr>
</tbody>
</table>

<p>
ONTO CG builds upon the results of the euBusinessGraph project.
The euBusinessGraph semantic model and dataset covers the following
(we have submitted a description of it to a prominent journal on semantic technologies):
</p>
<ul class="org-ul">
<li>Basic firmography (legal names, preferred name)</li>
<li>Basic person info</li>
<li>Geography, address, hieararchical administrative divisions</li>
<li>Company legal type and status</li>
<li>Industry classification (based on NACE)</li>
<li>Identifiers from Official registers and others</li>
<li>Company officers and directors (positions, using <code>org:Membership</code>)</li>
<li>Datasets, providers, dataset descriptions</li>
</ul>

<p>
ONTO-CG steps on the euBusinessGraph model and adds the following:
</p>

<ul class="org-ul">
<li><code>IdentifierSystems</code>: We extend the euBusinessGraph idea of generalized identifiers to record any kind of potentially useful identification info in a generic way: phone, email, website, blog, logo/image; profile links and identifiers in various external systems such as: Wikidata, DBpedia, Facebook, LinkedIn, Twitter, Youtube, Reddit, Github, CrunchBase, OpenCorporates, Thomson Reuters permid (TR), ISO 10383 Market Identifier Code (MIC); research-oriented identifiers such as CrossRef funder, Microsoft Academic Graph, Global Research Identifier Database (GRID), Research Organization Registry (ROR), Virtual International Authority File (VIAF).</li>
<li><code>cg:StockExchange</code>: a Stock exchange where companies can offer shares or other securities. We record MIC and TR exchange codes as identifiers.</li>
<li><code>cg:Event</code> and <code>cg:EventAppearance</code>: Conference, workshop, meetup, etc where the work of a certain person or company may be highlighted.</li>
<li><code>gn:Feature</code>: While the euBusinessGraph geographic hierarchy is based on EuroStat NUTS and LAU, ONTO-CG uses Geonames locations to implement geographic matching, auto-completion and faceting. We are particularly interested in the 3 levels Country, Region, City that we have defined as particular lists of gn:featureCodes (e.g. Country corresponds to <code>gn:A.PCLI, gn:A.PCLD, gn:A.PCLIX, gn:A.PCLS, gn:A.PCL, gn:A.TERR, gn:A.PCLF</code>).</li>
<li><code>cg:AcademicQualification</code>: Academic degree (completed or not) of a person at a scholl in an academic major.</li>
<li><code>qb:Observation</code>: Statistical or other observation about an object (typically company), such as annual sales, number of employees, etc. May be for a particular year, point in time, or without date (current).</li>
<li><code>cg:Transaction</code>: Financial transaction that gives money to a company in return for shares or other consideration.</li>
<li><code>cg:OrganizationRelation</code>: Relation between two agents. For asymmetric relations we use two fields "agentMinor" (e.g. subsidiary, owned, supplier) and "agentMajor" (e.g. parent, owner, customer); for symmetric relations we use the field "agent" twice. Usually these are Organizations, but "owner" could involve Persons.</li>
<li>Sourcing (provenance) for each node:
<ul class="org-ul">
<li><code>void:Dataset</code>: Dataset as source of entities</li>
<li><code>void:Linkset</code>: Linkset as source of identifiers (links)</li>
<li><code>cg:SourceMatch</code>: Cluster of matched lower-level entities as the source of a higher-level entity.</li>
</ul></li>
</ul>

<p>
In addition to the above new classes, ONTO-CG adds:
</p>
<ul class="org-ul">
<li>A 2-level data model where data from individual datasets sits at a lower (KG-building) level, and after matching and data fusion is promoted at a higher (data consumption) level.</li>
<li>Various extra fields, e.g. <code>cg:geoPrecision</code> "Precision of geo coordinates in meters (e.g. street address or building -&gt; 30.8)" to complement <code>ebg:geoResolution</code> "Resolution of geo coordinates as a categorial value (e.g. building -&gt; <code>&lt;resolution/L9&gt;</code>)"</li>
<li>Various flags, e.g. for Organization (<code>cg:isResearch</code>), Position (<code>cg:isCurrent, cg:isPrimary</code>), AcademicQualification (<code>cg:isCompleted</code>), ExchangeListing, OrganizationRelation (<code>cg:isCurrent</code>)</li>
<li>Business nomenclatures (<code>skos:ConceptScheme</code>): <code>Organization Type, Legal Form, Organization Status, Industry, Investor Type, Geo Coordinate Resolution, Address Type, Observation Type, Gender, Event Type, Event Appearance Type, Position Type, Transaction Type, Relation Type</code></li>
</ul>

<p>
The full CG schema is included: <a href="./img/CG.yaml">CG.yaml</a>. Below we show a couple of typical examples.
</p>
</div>

<div id="outline-container-org57936a4" class="outline-3">
<h3 id="org57936a4">Example Class:</h3>
<div class="outline-text-3" id="text-org57936a4">
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #a0522d;">ExchangeListing</span>:
  <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"Exchange Listing"</span>
  <span style="color: #a0522d;">inherits</span>: Transaction
  <span style="color: #a0522d;">type</span>: [cg:ExchangeListing]
  <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Public offering (IPO, SPO etc) wheres the company receives money from the wide public, and as a result is listed for trading on an exchange"</span>
  <span style="color: #a0522d;">props</span>:
    <span style="color: #a0522d;">exchange</span>:
      <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"exchange"</span>
      <span style="color: #a0522d;">range</span>: StockExchange
      <span style="color: #a0522d;">min</span>: 1
      <span style="color: #a0522d;">rdfProp</span>: cg:exchange
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Stock exchange"</span>
    <span style="color: #a0522d;">stockSymbol</span>:
      <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"stock symbol"</span>
      <span style="color: #a0522d;">range</span>: string
      <span style="color: #a0522d;">rdfProp</span>: cg:stockSymbol
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Stock symbol (ticker). </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #8b2252;">: this should also be represented as an Identifier?"</span>
    <span style="color: #a0522d;">valuation</span>:
      <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"valuation (MUSD)"</span>
      <span style="color: #a0522d;">range</span>: decimal
      <span style="color: #a0522d;">rdfProp</span>: cg:valuation
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Company valuation at IPO in MUSD"</span>
    <span style="color: #a0522d;">valuationLocal</span>:
      <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"valuation (M local currency)"</span>
      <span style="color: #a0522d;">range</span>: decimal
      <span style="color: #a0522d;">rdfProp</span>: cg:valuationLocal
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Company valuation at IPO in millions of local currency"</span>
    <span style="color: #a0522d;">valuationCurrency</span>:
      <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"valuation currency"</span>
      <span style="color: #a0522d;">range</span>: string
      <span style="color: #a0522d;">rdfProp</span>: cg:valuationCurrency
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Currency code of the valuation"</span>
    <span style="color: #a0522d;">dateEnd</span>:
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Date delisted or left this exchange"</span>
    <span style="color: #a0522d;">isCurrent</span>:
      <span style="color: #a0522d;">rdfProp</span>: cg:isCurrent
      <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Whether the listing is still effective"</span>
</pre>
</div>

<p>
If you look closely, you may wonder where the range and RDF mapping of <code>dateEnd</code> is defined.
It's in the list of reusable properties:
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #a0522d;">properties</span>: <span style="color: #b22222;"># </span><span style="color: #b22222;">reused props</span>
  <span style="color: #a0522d;">dateEnd</span>: {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"dateCompleted"</span>, <span style="color: #a0522d;">range</span>: dateOrYearOrMonth, <span style="color: #a0522d;">rdfProp</span>: cg:dateEnd}
</pre>
</div>

<p>
A more appropriate <code>descr</code> is given at the object level, overriding the generic description.
</p>
</div>
</div>

<div id="outline-container-org6b550ad" class="outline-3">
<h3 id="org6b550ad">Example Inverse Alias</h3>
<div class="outline-text-3" id="text-org6b550ad">
<p>
A Position is an associative node between Person and Organization that adds more data (not shown):
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #a0522d;">Position</span>:
  <span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"Position"</span>
  <span style="color: #a0522d;">inherits</span>: BusinessObject
  <span style="color: #a0522d;">type</span>: [org:Membership]
  <span style="color: #a0522d;">descr</span>: <span style="color: #8b2252;">"Position of a person in an organization, former or current"</span>
  <span style="color: #a0522d;">props</span>:
    <span style="color: #a0522d;">person</span>: {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"person"</span>, <span style="color: #a0522d;">range</span>: PersonCommon, <span style="color: #a0522d;">min</span>: 1, <span style="color: #a0522d;">rdfProp</span>: org:member}
    <span style="color: #a0522d;">organization</span>: {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"organization"</span>, <span style="color: #a0522d;">range</span>: OrganizationCommon, <span style="color: #a0522d;">min</span>: 1, <span style="color: #a0522d;">rdfProp</span>: org:organization}
</pre>
</div>

<p>
To allow navigation in any direction (not just from Position out, but also in), we add inverse aliases:
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #a0522d;">PersonCommon</span>:
  <span style="color: #a0522d;">props</span>:
    <span style="color: #a0522d;">position</span>: {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"position"</span>, <span style="color: #a0522d;">range</span>: Position, <span style="color: #a0522d;">inverseAlias</span>: person}
<span style="color: #a0522d;">OrganizationCommon</span>:
  <span style="color: #a0522d;">props</span>:
    <span style="color: #a0522d;">position</span>: {<span style="color: #a0522d;">label</span>: <span style="color: #8b2252;">"position"</span>, <span style="color: #a0522d;">range</span>: Position, <span style="color: #a0522d;">inverseAlias</span>: organization}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb3f78d3" class="outline-3">
<h3 id="orgb3f78d3">Example Diagram: Exchange Listing</h3>
<div class="outline-text-3" id="text-orgb3f78d3">
<p>
For example, the figure below shows the stock exchange listing (IPO) of Apple on the Tokyo exchange and NASDAQ, and the listing of Nasdaq Inc (the company) on NASDAQ (the stock exchange). The data is integrated from Wikidata. This figure is generated from RDF Turtle using <a href="https://github.com/VladimirAlexiev/rdf2rml">rdfpuml</a> (see V.Alexiev, <a href="http://rawgit2.com/VladimirAlexiev/my/master/pres/20161128-rdfpuml-rdf2rml/index.html">RDF by Example: rdfpuml for True RDF Diagrams, rdf2rml for R2RML Generation</a>, Semantic Web in Libraries (SWIB), Nov 2016.
</p>

<p>
<a href="./img/model-exchange-listing-mapped.ttl">./img/model-exchange-listing-mapped.ttl</a>
</p>


<div class="figure">
<p><img src="./img/model-exchange-listing-mapped.png" alt="model-exchange-listing-mapped.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org3c424ab" class="outline-2">
<h2 id="org3c424ab">SOML Tooling</h2>
<div class="outline-text-2" id="text-org3c424ab">
</div>
<div id="outline-container-orgae2c348" class="outline-3">
<h3 id="orgae2c348">tsv2soml</h3>
<div class="outline-text-3" id="text-orgae2c348">
<p>
Editing large schemas is often easier to do in a table, even when the schema language is simple.
(Also, this enables domain experts to participate in schema authoring, even if only editing the descriptions.)
</p>

<p>
The CG model was not written by hand, it was generated from a TSV (google sheet).
</p>

<p>
The sheet has 300 rows, and the generated SOML is 1176 lines.
Here's the beginning of the sheet:
</p>


<div class="figure">
<p><img src="./img/CG-sheet.png" alt="CG-sheet.png" />
</p>
</div>

<p>
Here is the end of the sheet, which exposes various thesauri (<code>ConceptSchemes</code>) 
as distinct business classes
</p>


<div class="figure">
<p><img src="./img/CG-sheet2.png" alt="CG-sheet2.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org893dfe5" class="outline-3">
<h3 id="org893dfe5">soml-map</h3>
</div>
</div>

<div id="outline-container-orga0f12e8" class="outline-2">
<h2 id="orga0f12e8">Tricky Points and Deficiencies</h2>
<div class="outline-text-2" id="text-orga0f12e8">
</div>
<div id="outline-container-org15d8bbf" class="outline-3">
<h3 id="org15d8bbf">GraphQL Type vs rdf:type</h3>
</div>

<div id="outline-container-org9fce966" class="outline-3">
<h3 id="org9fce966">No Multiple Typing</h3>
</div>

<div id="outline-container-orgf0fb16a" class="outline-3">
<h3 id="orgf0fb16a">Single vs Multiple-Value Props</h3>
</div>

<div id="outline-container-org2812962" class="outline-3">
<h3 id="org2812962">Inverse Aliases</h3>
</div>

<div id="outline-container-orgd69d00d" class="outline-3">
<h3 id="orgd69d00d">Literals (langString, union datatypes)</h3>
</div>

<div id="outline-container-orgd2e987c" class="outline-3">
<h3 id="orgd2e987c">Extended Pattern (Prefix + Regex)</h3>
</div>

<div id="outline-container-org019f209" class="outline-3">
<h3 id="org019f209">IRI Generation</h3>
</div>

<div id="outline-container-orgde99a22" class="outline-3">
<h3 id="orgde99a22">Schema Inclusion/Modularity</h3>
</div>

<div id="outline-container-orgeee9558" class="outline-3">
<h3 id="orgeee9558">Concrete Superclass</h3>
</div>

<div id="outline-container-org9e001b9" class="outline-3">
<h3 id="org9e001b9">Covariant Range</h3>
</div>

<div id="outline-container-org8e2065f" class="outline-3">
<h3 id="org8e2065f">Multiple Inheritance</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2020-02-12 Wed 00:00</p>
<p class="author">Author: Vladimir Alexiev</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
